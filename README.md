# ml-gw-search

This repository contains the code used for the MLGWSC-1 mock data challenge [1] in the submission titled TPI FSU Jena, authored by Ondřej Zelenka, Bernd Brügmann, and Frank Ohme.

* `split_noise_file.py`: Randomly splits an HDF5 file containing noise (originally meant to be used with `real_noise_file.hdf` supplied by the MDC) into two, preserving the individual datasets. Not strictly required but useful for generation of training and validation data with real noise.
* `slice_real_noise.py`: Whitens and slices an HDF5 file containing noise (meant for the first output file of the previous script, also can be used with `real_noise_file.hdf`). Necessary for generation of training and validation data with real noise.
* `gen.py`: Generates training and validation data. Can use Gaussian noise (generated at runtime) or real noise provided through the output of the previous script. Can use spinless IMRPhenomD or generic-spin IMRPhenomXPHM to generate injections.
* `train.py`: Trains the CNN using data generated by the previous script.
* `apply.py`: Applies the CNN trained by the previous script to test data and saves an HDF5 list of events.
* `whiten.py`: Whitens an HDF5 file of test data. Useful in cases where the same data is analyzed multiple times (e.g. CNN architecture optimization) without chaning the whitening parameters, `apply.py` accepts whitened data (the `--white` argument must be supplied).